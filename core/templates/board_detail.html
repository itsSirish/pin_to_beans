{% extends 'base.html' %}
{% block title %}{{ board.name }}{% endblock %}

{% block styles %}
<style>
    .empty-message {
        margin-left: 60px;
        color: #777;
        font-style: italic;
        padding: 20px;
    }
</style>
{% endblock %}

{% block content %}
<h2 style="margin-left: 60px; padding-top: 10px;">📌 Pins in {{ board.name }} ({{ board.category }})</h2>

<div class="pin-grid">
    {% for pin in pins %}
    <div class="pin-card">
        <div class="pin-image-wrapper">
            <a href="{% url 'pin_detail' pin.pin_id %}" data-ajax>
                <img src="{% url 'image_blob' pin.image.image_id %}" alt="Pin image">
            </a>

            <!-- <div class="overlay">
                <strong>{{ pin.user.name }}</strong><br>
                ❤️ {{ pin.likes_set.count }} Likes
            </div> -->

            {% if request.session.user_id != pin.user.user_id %}
            <div class="hover-repin">
                <form method="get" action="{% url 'repin_select_board' pin.pin_id %}" data-ajax>
                    <button type="submit">🔁 Repin</button>
                </form>
            </div>
            {% endif %}
        </div>

        <div class="actions">
            <div class="like-container">
                <form class="ajax-like-form" data-pin-id="{{ pin.pin_id }}">
                    {% csrf_token %}
                    <input type="hidden" name="pin_id" value="{{ pin.pin_id }}">
                    <button type="button" class="heart-button {% if pin.root_pin_id in liked_pins %}liked{% endif %}">
                        ❤️
                    </button>
                </form>
                <span class="like-count" data-pin-id="{{ pin.root_pin_id }}">
                    {{ pin.likes_set.count }}
                </span>
            </div>
        </div>
    </div>
    {% empty %}
        <p class="empty-message">No pins in this board yet.</p>
    {% endfor %}
</div>

<p style="margin-left: 60px; padding-bottom: 30px;">
    <a href="{% url 'pinboard_list' %}" data-ajax>← Back to Pinboards</a>
</p>
{% endblock %}
